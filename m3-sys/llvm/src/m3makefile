% m3-sys/llvm/src/m3makefile
% This is the Modula-3 binding to the C binding to the llvm infrastructure. 

import ("libm3")
Module ("LLVMTypes") 
Interface ("LLVM") 
Interface ("M3DIB") 

%include_dir("llvmlibs") %now copied in: 

% commands for linking in needed llvm static libraries. 
% NOTE: These are in this m3makefile for llvmbindings, because 
%       it is the code in this package that needs them.
%       However, the CM3 build system will not attempt to link
%       them in until it links a main program that (transitively)
%       includes this library.  In the meantime, these library
%       names are just accumulated in archives.  
%       That would include packages cm3 and m3llvmgen. 

if not defined("LLVM_LIB_DIR") LLVM_LIB_DIR = "/usr/local/lib" end
%if not defined("LLVM_LIB_DIR") LLVM_LIB_DIR = "/usr/local/llvm-3.6/lib" end

% These will be reversed in the link command generated by cm3: 
import_lib("curses","/usr/lib/x86_64-linux-gnu") 
import_lib("dl","/usr/lib/x86_64-linux-gnu")
import_lib("stdc++","/usr/lib/x86_64-linux-gnu")
import_lib("LTO",LLVM_LIB_DIR)
import_lib("LLVMBitWriter",LLVM_LIB_DIR)
import_lib("LLVMSupport",LLVM_LIB_DIR)
import_lib("LLVMCore",LLVM_LIB_DIR)
import_lib("M3LLVMCBindings",LLVM_LIB_DIR)
import_lib("LLVMBitReader",LLVM_LIB_DIR)
import_lib("LLVMAsmParser",LLVM_LIB_DIR)
import_lib("LLVMAnalysis",LLVM_LIB_DIR)
import_lib("LLVMTransformUtils",LLVM_LIB_DIR)
import_lib("LLVMScalarOpts",LLVM_LIB_DIR)
import_lib("LLVMTarget",LLVM_LIB_DIR)



build_standalone ()
Library ("llvm")

